<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:JLAClient.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:conv="clr-namespace:JLAClient.Converters"
        mc:Ignorable="d"
        Width="500" Height="1000" Padding="4"
        x:Class="JLAClient.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="JLAClient">
    <Window.Resources>
        <conv:StringArrayToString x:Key="stringArrayToString"/>
    </Window.Resources>


    <TabControl>
        <TabItem Header="Job Listings">
            <!-- We give a name to the root grid in order to access it later -->
            <Grid RowDefinitions="Auto, *" ShowGridLines = "true" x:Name="Root">
                <!--  This is our title text block. We use Style.Classes to style it accordingly  -->
                <StackPanel Orientation = "Vertical" Grid.Row = "0">
                    <StackPanel Orientation = "Vertical" HorizontalAlignment="Center">
                        <TextBlock Classes="h1" Text="Job Listings" TextAlignment="Center"/>
                        <TextBlock TextAlignment="Center">
                            <TextBlock.Text>
                                <MultiBinding StringFormat="{}{0} currently on display">
                                <Binding Path="Listings.Count"/>
                                </MultiBinding>
                            </TextBlock.Text>
                        </TextBlock>
                    </StackPanel>
                    <Button Command="{Binding #Root.((vm:MainWindowViewModel)DataContext).ClearListingsCommand}" CommandParameter="{Binding .}">
                        Delete All
                    </Button>
                </StackPanel>
                <ScrollViewer Grid.Row="1">
                    <!-- This ListingsControl show all added DisplayableJobListings. -->
                    <!-- It needs to be placed inside a ScrollViewer because other than a ListBox it has not its own -->
                    <ItemsControl ItemsSource="{Binding Listings}">
                        <ItemsControl.ItemTemplate>
                            <!--  The ItemTemplate defines how each item should be represented  -->
                            <DataTemplate DataType="vm:ListingViewModel">
                                <Grid ColumnDefinitions="*, Auto">
                                    <StackPanel>
                                    <CheckBox Content="{Binding Listing.Title}"
                                            IsChecked="{Binding HasBeenViewed}" />
                                    <TextBlock Text="{Binding Listing.PostDateTime}"/>
                                    <TextBlock Text="{Binding Listing.Company}"/>
                                    <TextBlock Text="{Binding Listing.Location}"/>
                                    <TextBlock Text="{Binding Listing.JobsiteId}"/>
                                    <HyperlinkButton Content="Go To Listing" NavigateUri="{Binding Listing.LinkToJobListing}"/>
                                    </StackPanel>
                                    <!--  Note how we use the Root-Grid to get the MainWindowViewModel here. As we use compiled bindings we have to cast the DataContext  -->
                                    <Button Command="{Binding #Root.((vm:MainWindowViewModel)DataContext).RemoveListingCommand}"
                                            CommandParameter="{Binding .}"
                                            Grid.Column="1">
                                        Delete
                                    </Button>
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </Grid>
        </TabItem>
        <TabItem Header="Schedule">
            <!-- We give a name to the root grid in order to access it later -->
            <Grid RowDefinitions="Auto, *, Auto" ShowGridLines = "true" x:Name="ConfigRoot">
                <!--  This is our title text block. We use Style.Classes to style it accordingly  -->
                <StackPanel Orientation = "Vertical" Grid.Row = "0">
                    <TextBlock Classes="h1" Text="My Scheduled Updates"/>
                    <Button Command="{Binding #Root.((vm:MainWindowViewModel)DataContext).ClearRulesCommand}" CommandParameter="{Binding .}">
                        Delete All
                    </Button>
                </StackPanel>

                <ScrollViewer Grid.Row="1">
                    <!-- This RuleControl show all added Rules. -->
                    <ItemsControl ItemsSource="{Binding Rules}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate DataType="vm:RuleViewModel">
                                <Grid ColumnDefinitions="*, Auto">
                                    <StackPanel>
                                        <TextBlock Text="{Binding Name}"/>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Interval: "/>
                                            <TextBlock Text="{Binding Interval}"/>
                                            <TextBlock Text = " seconds"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Daily Start Time: "/>
                                            <TextBlock Text="{Binding DailyStartTime}"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Daily End TIme: "/>
                                            <TextBlock Text="{Binding DailyEndTime}"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Source: "/>
                                            <TextBlock Text="{Binding RequestSpecifications.Source}"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Is Remote: "/>
                                            <TextBlock Text="{Binding RequestSpecifications.IsRemote}"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Search Radius (mi): "/>
                                            <TextBlock Text="{Binding RequestSpecifications.Radius}"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Search Terms: "/>
                                            <TextBlock Text="{Binding RequestSpecifications.SearchTerms}"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="City: "/>
                                            <TextBlock Text="{Binding RequestSpecifications.City}"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="State: "/>
                                            <TextBlock Text="{Binding RequestSpecifications.State}"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Company Exclusions: "/>
                                            <TextBlock Text="{Binding RequestSpecifications.CompanyFilterTerms, Converter={StaticResource stringArrayToString}}"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Job Title Keyword Exclusions: "/>
                                            <TextBlock Text="{Binding RequestSpecifications.TitleFilterTerms, Converter={StaticResource stringArrayToString}}"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="BuiltIn Min Salary: "/>
                                            <TextBlock Text="{Binding RequestSpecifications.MinSalary}"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="BuiltIn Max Salary: "/>
                                            <TextBlock Text="{Binding RequestSpecifications.MaxSalary}"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="BuiltIn Job Category: "/>
                                            <TextBlock Text="{Binding RequestSpecifications.BuiltInJobCategory}"/>
                                        </StackPanel>
                                    </StackPanel>
                                    <!--  Note how we use the Root-Grid to get the MainWindowViewModel here. As we use compiled bindings we have to cast the DataContext  -->
                                    <StackPanel Grid.Column="1" Orientation="Vertical">
                                        <Button Command="{Binding #ConfigRoot.((vm:MainWindowViewModel)DataContext).RemoveRuleCommand}"
                                            CommandParameter="{Binding .}">
                                            Delete
                                        </Button>
                                        <Button Command="{Binding #ConfigRoot.((vm:MainWindowViewModel)DataContext).ImportRuleToFormCommand}"
                                            CommandParameter="{Binding .}">
                                            Edit
                                        </Button>
                                    </StackPanel>
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
                <Expander VerticalAlignment="Bottom" Grid.Row="2" IsExpanded="{Binding IsRuleEditorExpanded}" HorizontalAlignment="Stretch">
                    <Expander.Header>
                        Add / Update Rules
                    </Expander.Header>
                    <Grid ColumnDefinitions="Auto, *" RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto" ShowGridLines="false">
                        <TextBlock Text="Name: " Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBox Text = "{Binding NewRuleName}" Grid.Row="0" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBlock Text="Interval (seconds): " Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <NumericUpDown Value="{Binding NewRuleInterval}" Grid.Row="1" Grid.Column="1" Increment="1" FormatString="0" Minimum="0" AllowSpin="false" ShowButtonSpinner="false" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBlock Text="Daily Start Time: " Grid.Row="2" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TimePicker ClockIdentifier="24HourClock" MinuteIncrement="5" Grid.Row="2" Grid.Column="1" SelectedTime="{Binding NewRuleDailyStartTime}" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBlock Text="Daily End Time: " Grid.Row="3" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TimePicker ClockIdentifier="24HourClock" MinuteIncrement="5" Grid.Row="3" Grid.Column="1" SelectedTime="{Binding NewRuleDailyEndTime}" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBlock Text="Job Listing Source: " Grid.Row="4" Grid.Column="0" VerticalAlignment="Center"/>
                        <ComboBox ItemsSource="{Binding AcceptedSources}" SelectedValue="{Binding NewRuleSource}" Grid.Row="4" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding}" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                        <TextBlock Text="Remote: " Grid.Row="5" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <CheckBox IsChecked="{Binding NewRuleIsRemote}" Grid.Row="5" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBlock Text="Radius (mi): " Grid.Row="6" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <NumericUpDown Value="{Binding NewRuleRadius}" Grid.Row="6" Grid.Column="1" Increment="1" FormatString="0" Minimum="1" AllowSpin="false" ShowButtonSpinner="false" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBlock Text="Search Terms: " Grid.Row="7" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBox Text = "{Binding NewRuleSearchTerms}" Grid.Row="7" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBlock Text="Cultural (eg 'en-US'): " Grid.Row="8" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBox Text = "{Binding NewRuleCulture}" Grid.Row="8" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBlock Text="City: " Grid.Row="9" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBox Text = "{Binding NewRuleCity}" Grid.Row="9" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBlock Text="State: " Grid.Row="10" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBox Text = "{Binding NewRuleState}" Grid.Row="10" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBlock Text="State Abbreviation: " Grid.Row="11" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBox Text = "{Binding NewRuleStateAbbrev}" Grid.Row="11" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBlock Text="Latitude: " Grid.Row="12" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBox Text = "{Binding NewRuleLatitudeString}" Grid.Row="12" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBlock Text="Longitude: " Grid.Row="13" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBox Text = "{Binding NewRuleLongitudeString}" Grid.Row="13" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBlock Text="GeoId: " Grid.Row="14" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBox Text = "{Binding NewRuleGeoId}" Grid.Row="14" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBlock Text="Minimum Salary ($/yr): " Grid.Row="15" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <NumericUpDown Value="{Binding NewRuleMinSalary}" Grid.Row="15" Grid.Column="1" Increment="1000" FormatString="0,000" Minimum="0" AllowSpin="false" ShowButtonSpinner="false" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBlock Text="Maximum Salary ($/yr): " Grid.Row="16" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <NumericUpDown Value="{Binding NewRuleMaxSalary}" Grid.Row="16" Grid.Column="1" Increment="1000" FormatString="0,000" Minimum="0" AllowSpin="false" ShowButtonSpinner="false" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBlock Text="BuiltIn Job Category: " Grid.Row="17" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBox Text = "{Binding NewRuleJobCategory}" Grid.Row="17" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBlock Text="Job Title Keyword Filters: " Grid.Row="18" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBox Text = "{Binding NewRuleTitleFilterArrayString}" Grid.Row="18" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBlock Text="Job Company Filters: " Grid.Row="19" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBox Text = "{Binding NewRuleCompanyFilterArrayString}" Grid.Row="19" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <Button Command="{Binding ClearFormCommand}" Grid.Row="20" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left">Clear</Button>
                        <Button Command="{Binding AddOrUpdateRuleCommand}" Grid.Row="20" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left">Add / Update</Button>
                    </Grid>
                </Expander>
            </Grid>
        </TabItem>
    </TabControl>
</Window>
